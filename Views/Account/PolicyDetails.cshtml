@model claims_website.Models.PolicyViewModel
@{
    ViewData["Title"] = "Policy Details";
}

<div class="container py-4">
    <div class="d-flex align-items-center mb-4">
        <a href="/Policies" class="btn btn-outline-secondary me-3">&larr; Back</a>
        <div>
            <h2 class="mb-0">Policy #@Model.PolicyNo</h2>
            <small class="text-muted">@Model.VehicleDescription • @Model.ChassisNo</small>
        </div>
        <div class="ms-auto">
            <span class="badge @Model.StatusBadgeClass fs-5">@Model.StatusText</span>
        </div>
    </div>

    <div class="row">
        <div class="col-md-8">
            
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-light fw-bold">Coverage Details</div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-sm-6">
                            <label class="text-muted small">Plan Name</label>
                            <p class="fw-bold">@Model.Product</p>
                        </div>
                        <div class="col-sm-6">
                            <label class="text-muted small">Usage Type</label>
                            <p class="fw-bold">@Model.Usage</p>
                        </div>
                        <div class="col-sm-6">
                            <label class="text-muted small">Effective Date</label>
                            <p>@(Model.StartDate.HasValue ? Model.StartDate.Value.ToShortDateString() : "N/A")</p>
                        </div>
                        <div class="col-sm-6">
                            <label class="text-muted small">Expiry Date</label>
                            <p>@(Model.EndDate.HasValue ? Model.EndDate.Value.ToShortDateString() : "N/A")</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card shadow-sm mb-4">
                <div class="card-header bg-light fw-bold">Financials</div>
                <div class="card-body">
                    <div class="row text-center">
                        <div class="col-4 border-end">
                            <label class="text-muted small">Sum Insured</label>
                            <h4 class="text-primary">@Model.SumInsured.ToString("C0")</h4>
                            <small class="text-muted">Max Payout</small>
                        </div>
                        <div class="col-4 border-end">
                            <label class="text-muted small">Annual Premium</label>
                            <h4>@Model.Premium.ToString("C0")</h4>
                            <small class="text-muted">Cost per Year</small>
                        </div>
                        <div class="col-4">
                            <label class="text-muted small">Deductible</label>
                            <h4 class="text-danger">@Model.Deductible.ToString("C0")</h4>
                            <small class="text-muted">You pay this first</small>
                        </div>
                    </div>
                </div>
            </div>

            @if(Model.ClaimsHistory.Any())
            {
                <h4 class="mb-3">Claims History</h4>
                <div class="list-group">
                    @foreach(var claim in Model.ClaimsHistory)
                    {
                        <a href="/Claims/Details/@claim.ClaimNo" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                            <div>
                                <div class="fw-bold">@claim.Type</div>
                                <small class="text-muted">@claim.IncidentDate.ToShortDateString() • @claim.Severity</small>
                            </div>
                            <span class="badge bg-dark rounded-pill">@claim.TotalAmount.ToString("C0")</span>
                        </a>
                    }
                </div>
            }
            else
            {
                 <div class="alert alert-success">No claims filed for this vehicle. Great driving!</div>
            }
        </div>

        <div class="col-md-4">
            <div class="card shadow-sm">
                <div class="card-body d-grid gap-3">
                    <h5 class="card-title">Quick Actions</h5>
                    
                    <a href="@Model.PolicyDocumentUrl" class="btn btn-outline-primary" target="_blank">
                        <i class="bi bi-file-earmark-pdf"></i> Download Certificate
                    </a>

                    @if(Model.IsActive)
                    {
                        <a href="/Claims/Create?policyId=@Model.PolicyNo" class="btn btn-danger">
                            <i class="bi bi-exclamation-triangle"></i> Report an Accident
                        </a>
                    }
                    else
                    {
                         <button class="btn btn-success">Renew Policy</button>
                    }
                    
                    <hr>
                    <div class="text-muted small">
                        Need help? Call support at <br>
                        <strong>1-800-INSURE-ME</strong> <br>
                        Ref ID: <code>@Model.PolicyNo</code>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>